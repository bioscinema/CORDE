% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util.R
\name{get_mantel_C_matrix}
\alias{get_mantel_C_matrix}
\title{Compute Mantel-based Correlation Matrix Between OTUs and Environmental Axes}
\usage{
get_mantel_C_matrix(otu_mat, E, dist_method = "bray", n_perm = 0)
}
\arguments{
\item{otu_mat}{A matrix of OTU/ASV abundances (samples × features).}

\item{E}{A numeric matrix of environmental or ordination axes (samples × axes).}

\item{dist_method}{Character string indicating the distance metric for OTU dissimilarity
(default is `"bray"` for Bray-Curtis; passed to \code{\link[vegan]{vegdist}}).}

\item{n_perm}{Integer, number of permutations for the Mantel test (default = 0, i.e., no permutation test).}
}
\value{
A numeric matrix with dimensions (number of OTUs × number of axes) containing
  Mantel correlation coefficients (Mantel r) for each OTU-axis pair.
}
\description{
This function computes a Mantel statistic matrix (`C matrix`) measuring the correlation
between dissimilarity profiles of each OTU and each axis of a given environmental or
ordination matrix.
}
\details{
A small pseudocount (0.5) is added to each OTU profile to avoid zero-distance artifacts.
  The function uses \code{\link[vegan]{mantel}} to compute the Mantel statistic.
}
\examples{
\dontrun{
# Example OTU table (samples × OTUs) and ordination axes
otu_mat <- matrix(rpois(100, lambda = 5), nrow = 10)
colnames(otu_mat) <- paste0("OTU", 1:10)
E <- matrix(rnorm(20), nrow = 10, ncol = 2)
colnames(E) <- c("Axis1", "Axis2")

C_mat <- get_mantel_C_matrix(otu_mat, E, dist_method = "bray", n_perm = 99)
print(C_mat)
}

}
