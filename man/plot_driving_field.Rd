% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Driving_Fields.R
\name{plot_driving_field}
\alias{plot_driving_field}
\title{Plot Vector Field After Removing a Driving OTU}
\usage{
plot_driving_field(otu_df, otu_to_remove, diss, corde_df, X, Y, alpha)
}
\arguments{
\item{otu_df}{A matrix or data frame of OTU abundances (samples × taxa).}

\item{otu_to_remove}{Character vector of one or more OTU (column) names to be removed.}

\item{diss}{Character string specifying the dissimilarity metric (e.g., \code{"bray"}).}

\item{corde_df}{A data frame returned from a CORDE-like analysis, containing columns named \code{"SampleID"}, \code{"PC1"}, \code{"PC2"}, \code{"Cluster"}, and \code{"Group"}.}

\item{X}{A design matrix of confounders (samples × covariates).}

\item{Y}{A factor vector of group labels.}

\item{alpha}{Numeric scalar controlling arrow length in the plot (e.g., 0.5).}
}
\value{
A \code{ggplot} object showing the vector field of sample movement after OTU removal.
Polygon hulls are plotted around re-labeled clusters, and arrow segments illustrate the shift direction.
}
\description{
This function visualizes the effect of removing a selected OTU on the low-dimensional ordination
space derived from sPLSDA. It overlays vector arrows indicating the change in sample coordinates
after OTU removal, helping to interpret the contribution of a taxon to group separation.
}
\details{
The function:
\itemize{
  \item Removes the selected OTU(s) from the input.
  \item Recomputes a PCoA embedding of the new OTU table.
  \item Removes confounding effects using a projection matrix.
  \item Applies \code{splsda} to extract new components.
  \item Plots arrows from the original component scores to the new ones.
  \item Reassigns clusters using the Kuhn-Munkres algorithm for interpretability.
}
}
\examples{
\dontrun{
plot_driving_field(
  otu_df = otu_matrix,
  otu_to_remove = "OTU_42",
  diss = "bray",
  corde_df = corde_output,
  X = confounder_matrix,
  Y = sample_labels,
  alpha = 0.7
)
}

}
