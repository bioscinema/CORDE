% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Driving_Taxa.R
\name{evaluate_taxon_removal_effect}
\alias{evaluate_taxon_removal_effect}
\title{Evaluate the Effect of Removing a Taxon on Dissimilarity Structure}
\usage{
evaluate_taxon_removal_effect(otu_df, remove_otu, group, diss)
}
\arguments{
\item{otu_df}{A numeric matrix or data frame of OTU abundances (rows = taxa, columns = samples).}

\item{remove_otu}{A character vector of taxon (row) names to be removed from \code{otu_df}.}

\item{group}{A factor or character vector indicating group membership for each sample (length must match number of columns in \code{otu_df}).}

\item{diss}{Character string specifying the dissimilarity metric used by \code{vegdist} (e.g., \code{"bray"}, \code{"euclidean"}).}
}
\value{
A data frame summarizing the effect of OTU removal, with the following columns:
\describe{
  \item{comparison}{Comparison level: overall ("between group") and per group.}
  \item{mantel_p}{Mantel test p-value comparing dissimilarities before and after OTU removal.}
  \item{proc_p}{Procrustes test p-value comparing ordinations before and after OTU removal.}
  \item{silhouette_difference}{Change in silhouette width (overall or medoid distance).}
  \item{silhouette_difference_pvalue}{Wilcoxon test p-value comparing silhouette widths or medoid distances.}
}
}
\description{
This function quantifies the impact of removing one or more taxa from an OTU table
on community structure, using dissimilarity matrices, silhouette scores, Mantel tests,
and Procrustes analysis.
}
\details{
This function performs the following:
\itemize{
  \item Computes baseline dissimilarity and silhouette scores.
  \item Identifies group-specific medoids using PAM clustering.
  \item Recomputes dissimilarity matrix after removing specified taxa.
  \item Assesses structural shifts via Mantel and Procrustes tests at group and global levels.
  \item Compares silhouette and medoid distances using paired Wilcoxon tests.
}
}
\examples{
\dontrun{
otu_mat <- matrix(rpois(100, 5), nrow = 10)
rownames(otu_mat) <- paste0("OTU", 1:10)
colnames(otu_mat) <- paste0("Sample", 1:10)
group <- rep(c("A", "B"), each = 5)
evaluate_taxon_removal_effect(otu_mat, remove_otu = "OTU5", group = group, diss = "bray")
}

}
\seealso{
\code{\link[vegan]{mantel}}, \code{\link[vegan]{protest}}, \code{\link[cluster]{silhouette}}, \code{\link[cluster]{pam}}
}
